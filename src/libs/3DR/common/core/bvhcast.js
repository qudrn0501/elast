const _0x10a3ed=_0x167f;(function(_0x40294c,_0x3c69fc){const _0x584be9=_0x167f,_0x828add=_0x40294c();while(!![]){try{const _0x1c3586=-parseInt(_0x584be9(0x13f))/0x1+-parseInt(_0x584be9(0x150))/0x2+parseInt(_0x584be9(0x153))/0x3+-parseInt(_0x584be9(0x154))/0x4*(parseInt(_0x584be9(0x14f))/0x5)+-parseInt(_0x584be9(0x147))/0x6*(-parseInt(_0x584be9(0x14c))/0x7)+-parseInt(_0x584be9(0x13c))/0x8*(-parseInt(_0x584be9(0x145))/0x9)+-parseInt(_0x584be9(0x13a))/0xa;if(_0x1c3586===_0x3c69fc)break;else _0x828add['push'](_0x828add['shift']());}catch(_0x55f6e2){_0x828add['push'](_0x828add['shift']());}}}(_0x392d,0xd09e7));import{Box3}from'../../../build/three.module.js';import{OrientedBox}from'../math/OrientedBox.js';import{arrayToBox}from'../utils/ArrayBoxUtilities.js';import{PrimitivePool}from'../utils/PrimitivePool.js';function _0x167f(_0x22f481,_0x3fd624){const _0x392dc6=_0x392d();return _0x167f=function(_0x167f7e,_0x4842d5){_0x167f7e=_0x167f7e-0x138;let _0x48b6b5=_0x392dc6[_0x167f7e];return _0x48b6b5;},_0x167f(_0x22f481,_0x3fd624);}import{COUNT,OFFSET,LEFT_NODE,RIGHT_NODE,IS_LEAF,BOUNDING_DATA_INDEX}from'./nodeBufferFunctions.js';function _0x392d(){const _0x4808c3=['getPrimitive','intersectsBox','4026444vdhRva','390256TqltLn','has','applyMatrix4','matrix','4438480upTbPH','geometry','80KRBDmz','pop','forEach','60672RZBhoi','_roots','needsUpdate','clear','length','byteLength','905337iJgtfK','attributes','21192QRvdSK','get','bvhcast','copy','releasePrimitive','2051LSpkLi','set','push','85UZxARI','730686WbSYdq'];_0x392d=function(){return _0x4808c3;};return _0x392d();}import{MeshBVH}from'./MeshBVH.js';import{setTriangle}from'../utils/TriangleUtilities.js';import{ExtendedTriangle}from'../math/ExtendedTriangle.js';const trianglePool=new PrimitivePool(()=>new ExtendedTriangle());MeshBVH['prototype'][_0x10a3ed(0x149)]=function(_0x32e75f,_0xc94d7b,_0x38d79b){const _0x27cf5e=_0x10a3ed;let {intersectsRange:_0x321326,intersectsTriangle:_0x4b6a7a}=_0x38d79b;const _0x18c4a5=_0x32e75f[_0x27cf5e(0x13b)],_0x5b7348=_0x18c4a5['index'],_0x502af0=_0x18c4a5[_0x27cf5e(0x146)]['position'],_0x58161c=trianglePool[_0x27cf5e(0x151)](),_0x1c39ce=trianglePool[_0x27cf5e(0x151)]();if(_0x4b6a7a){function _0x57701f(_0x5e1af4,_0x2c41ad,_0x3b930e,_0x441c66,_0x483009,_0x16b246,_0x1078ba,_0x277abf){const _0x43c2ee=_0x27cf5e;for(let _0x198ace=_0x3b930e,_0x40b1d6=_0x3b930e+_0x441c66;_0x198ace<_0x40b1d6;_0x198ace++){setTriangle(_0x1c39ce,_0x198ace*0x3,_0x5b7348,_0x502af0),_0x1c39ce['a'][_0x43c2ee(0x138)](_0xc94d7b),_0x1c39ce['b'][_0x43c2ee(0x138)](_0xc94d7b),_0x1c39ce['c'][_0x43c2ee(0x138)](_0xc94d7b),_0x1c39ce[_0x43c2ee(0x141)]=!![];for(let _0x5617a4=_0x5e1af4,_0x43ab51=_0x5e1af4+_0x2c41ad;_0x5617a4<_0x43ab51;_0x5617a4++){setTriangle(_0x58161c,_0x5617a4*0x3,_0x5b7348,_0x502af0),_0x58161c['needsUpdate']=!![];if(_0x4b6a7a(_0x58161c,_0x1c39ce,_0x5617a4,_0x198ace,_0x483009,_0x16b246,_0x1078ba,_0x277abf))return!![];}}return![];}if(_0x321326){const _0x30947d=_0x321326;_0x321326=function(_0x4bd20e,_0x40a920,_0x4341e6,_0xf1a831,_0xfcf794,_0x3e7ab8,_0x23fb9e,_0x1fe8f2){if(!_0x30947d(_0x4bd20e,_0x40a920,_0x4341e6,_0xf1a831,_0xfcf794,_0x3e7ab8,_0x23fb9e,_0x1fe8f2))return _0x57701f(_0x4bd20e,_0x40a920,_0x4341e6,_0xf1a831,_0xfcf794,_0x3e7ab8,_0x23fb9e,_0x1fe8f2);return!![];};}else _0x321326=_0x57701f;}let _0x134f52=![],_0x30abb0=0x0,_0x52eca3=0x0;for(const _0x1a2034 of this[_0x27cf5e(0x140)]){setBuffer(_0x1a2034);for(const _0x560d50 of _0x32e75f[_0x27cf5e(0x140)]){setBuffer2(_0x560d50),_0x134f52=bvhcast(0x0,0x0,_0xc94d7b,_0x321326,_0x30abb0,_0x52eca3),clearBuffer2();if(_0x134f52)break;_0x52eca3+=_0x560d50['byteLength'];}clearBuffer();if(_0x134f52)break;_0x30abb0+=_0x1a2034[_0x27cf5e(0x144)];}return trianglePool[_0x27cf5e(0x14b)](_0x58161c),trianglePool['releasePrimitive'](_0x1c39ce),_0x134f52;};export const bvhcast=(function(){const _0x341a65=new PrimitivePool(()=>new OrientedBox()),_0x397fab=new PrimitivePool(()=>new Box3()),_0x46abf3=new Map(),_0x191f65=new Map();function _0x5a58a9(_0xbcd629,_0xb0a7aa){const _0x4c38c5=_0x167f;let _0x146e99;return _0x191f65[_0x4c38c5(0x155)](_0xbcd629)?_0x146e99=_0x191f65[_0x4c38c5(0x148)](_0xbcd629):(_0x146e99=_0x397fab[_0x4c38c5(0x151)](),_0x191f65[_0x4c38c5(0x14d)](_0xbcd629,_0x146e99),arrayToBox(BOUNDING_DATA_INDEX(_0xbcd629),_0xb0a7aa,_0x146e99)),_0x146e99;}function _0x5758b8(_0x52b1b7,_0x263973,_0x425ba0){const _0x248b59=_0x167f;let _0xe39557;return _0x46abf3[_0x248b59(0x155)](_0x52b1b7)?_0xe39557=_0x46abf3[_0x248b59(0x148)](_0x52b1b7):(_0xe39557=_0x341a65['getPrimitive'](),_0x46abf3['set'](_0x52b1b7,_0xe39557),arrayToBox(BOUNDING_DATA_INDEX(_0x52b1b7),_0x263973,_0xe39557),_0xe39557[_0x248b59(0x139)][_0x248b59(0x14a)](_0x425ba0),_0xe39557[_0x248b59(0x141)]=!![]),_0xe39557;}return function _0x382c5d(_0x258926,_0x24d326,_0x435fe6,..._0x5c558b){const _0x364a71=_0x167f;return _0x46abf3[_0x364a71(0x13e)](_0x3b5723=>_0x341a65[_0x364a71(0x14b)](_0x3b5723)),_0x46abf3[_0x364a71(0x142)](),_0x191f65[_0x364a71(0x13e)](_0x45c326=>_0x397fab['releasePrimitive'](_0x45c326)),_0x191f65[_0x364a71(0x142)](),_0x24506a(_0x258926,_0x24d326,_0x435fe6,..._0x5c558b);};function _0x24506a(_0x1752e9,_0x5eee0b,_0x104ea1,_0x53c805,_0x1d87db=0x0,_0x40fcd7=0x0,_0x410d27=0x0,_0x7c154e=0x0){const _0x535c83=_0x167f,_0x52f10c=_float32Array,_0x3e89a7=_uint16Array,_0x58299b=_uint32Array,_0x20c3e7=_float32Array2,_0x22dddb=_uint16Array2,_0x5b3229=_uint32Array2,_0x444732=IS_LEAF(_0x1752e9*0x2,_0x3e89a7),_0x449318=IS_LEAF(_0x5eee0b*0x2,_0x22dddb);if(_0x444732&&_0x449318)return _0x53c805(OFFSET(_0x1752e9,_0x58299b),COUNT(_0x1752e9*0x2,_0x3e89a7),OFFSET(_0x5eee0b,_0x5b3229),COUNT(_0x5eee0b*0x2,_0x22dddb),_0x410d27,_0x1d87db+_0x1752e9,_0x7c154e,_0x40fcd7+_0x5eee0b);else{if(_0x444732||_0x449318){let _0x4e88c8=_0x444732?0x2:0x1;const _0x5901b7=_0x5a58a9(_0x1752e9,_0x52f10c),_0x1e36c1=_0x5758b8(_0x5eee0b,_0x20c3e7,_0x104ea1);if(_0x4e88c8===0x1){const _0x2734d0=LEFT_NODE(_0x1752e9),_0x52a313=RIGHT_NODE(_0x1752e9,_0x58299b),_0x128321=_0x5a58a9(_0x2734d0,_0x52f10c),_0x26ef59=_0x5a58a9(_0x52a313,_0x52f10c);if(_0x1e36c1[_0x535c83(0x152)](_0x128321)&&_0x24506a(_0x2734d0,_0x5eee0b,_0x104ea1,_0x53c805,_0x1d87db,_0x40fcd7,_0x410d27+0x1,_0x7c154e))return!![];if(_0x1e36c1['intersectsBox'](_0x26ef59)&&_0x24506a(_0x52a313,_0x5eee0b,_0x104ea1,_0x53c805,_0x1d87db,_0x40fcd7,_0x410d27+0x1,_0x7c154e))return!![];}else{const _0x575e34=LEFT_NODE(_0x5eee0b),_0x3cd1dc=RIGHT_NODE(_0x5eee0b,_0x5b3229),_0x1039ea=_0x5758b8(_0x575e34,_0x20c3e7,_0x104ea1),_0x233921=_0x5758b8(_0x3cd1dc,_0x20c3e7,_0x104ea1);if(_0x1039ea[_0x535c83(0x152)](_0x5901b7)&&_0x24506a(_0x1752e9,_0x575e34,_0x104ea1,_0x53c805,_0x1d87db,_0x40fcd7,_0x410d27,_0x7c154e+0x1))return!![];if(_0x233921['intersectsBox'](_0x5901b7)&&_0x24506a(_0x1752e9,_0x3cd1dc,_0x104ea1,_0x53c805,_0x1d87db,_0x40fcd7,_0x410d27,_0x7c154e+0x1))return!![];}}else{const _0x10e1c5=LEFT_NODE(_0x1752e9),_0xde2f10=RIGHT_NODE(_0x1752e9,_0x58299b),_0xccc84f=LEFT_NODE(_0x5eee0b),_0xd1102d=RIGHT_NODE(_0x5eee0b,_0x5b3229),_0x4a3f58=_0x5a58a9(_0x10e1c5,_0x52f10c),_0x148139=_0x5a58a9(_0xde2f10,_0x52f10c),_0x32c695=_0x5758b8(_0xccc84f,_0x20c3e7,_0x104ea1),_0x3e5f35=_0x5758b8(_0xd1102d,_0x20c3e7,_0x104ea1);if(_0x32c695[_0x535c83(0x152)](_0x4a3f58)&&_0x24506a(_0x10e1c5,_0xccc84f,_0x104ea1,_0x53c805,_0x1d87db,_0x40fcd7,_0x410d27+0x1,_0x7c154e+0x1))return!![];if(_0x32c695[_0x535c83(0x152)](_0x148139)&&_0x24506a(_0xde2f10,_0xccc84f,_0x104ea1,_0x53c805,_0x1d87db,_0x40fcd7,_0x410d27+0x1,_0x7c154e+0x1))return!![];if(_0x3e5f35['intersectsBox'](_0x4a3f58)&&_0x24506a(_0x10e1c5,_0xd1102d,_0x104ea1,_0x53c805,_0x1d87db,_0x40fcd7,_0x410d27+0x1,_0x7c154e+0x1))return!![];if(_0x3e5f35[_0x535c83(0x152)](_0x148139)&&_0x24506a(_0xde2f10,_0xd1102d,_0x104ea1,_0x53c805,_0x1d87db,_0x40fcd7,_0x410d27+0x1,_0x7c154e+0x1))return!![];}}return![];}}());const bufferStack=[];let _prevBuffer,_float32Array,_uint16Array,_uint32Array;export function setBuffer(_0x70474d){const _0x362f64=_0x10a3ed;_prevBuffer&&bufferStack[_0x362f64(0x14e)](_prevBuffer),_prevBuffer=_0x70474d,_float32Array=new Float32Array(_0x70474d),_uint16Array=new Uint16Array(_0x70474d),_uint32Array=new Uint32Array(_0x70474d);}export function clearBuffer(){_prevBuffer=null,_float32Array=null,_uint16Array=null,_uint32Array=null,bufferStack['length']&&setBuffer(bufferStack['pop']());}const bufferStack2=[];let _prevBuffer2,_float32Array2,_uint16Array2,_uint32Array2;export function setBuffer2(_0x9e829a){const _0x67d5e5=_0x10a3ed;_prevBuffer2&&bufferStack2[_0x67d5e5(0x14e)](_prevBuffer2),_prevBuffer2=_0x9e829a,_float32Array2=new Float32Array(_0x9e829a),_uint16Array2=new Uint16Array(_0x9e829a),_uint32Array2=new Uint32Array(_0x9e829a);}export function clearBuffer2(){const _0x39cb48=_0x10a3ed;_prevBuffer2=null,_float32Array2=null,_uint16Array2=null,_uint32Array2=null,bufferStack2[_0x39cb48(0x143)]&&setBuffer(bufferStack2[_0x39cb48(0x13d)]());}