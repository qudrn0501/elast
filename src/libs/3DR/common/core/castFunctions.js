(function(_0x240bfa,_0x19d863){const _0x44e3de=_0x2f09,_0x2c92b9=_0x240bfa();while(!![]){try{const _0x2c409b=parseInt(_0x44e3de(0x19c))/0x1*(parseInt(_0x44e3de(0x192))/0x2)+parseInt(_0x44e3de(0x1a0))/0x3*(parseInt(_0x44e3de(0x189))/0x4)+parseInt(_0x44e3de(0x18b))/0x5+-parseInt(_0x44e3de(0x197))/0x6+parseInt(_0x44e3de(0x182))/0x7*(-parseInt(_0x44e3de(0x196))/0x8)+parseInt(_0x44e3de(0x191))/0x9+parseInt(_0x44e3de(0x18e))/0xa*(-parseInt(_0x44e3de(0x18f))/0xb);if(_0x2c409b===_0x19d863)break;else _0x2c92b9['push'](_0x2c92b9['shift']());}catch(_0x15cd3b){_0x2c92b9['push'](_0x2c92b9['shift']());}}}(_0x408c,0xa2016));import{Box3,Vector3,Matrix4}from'../../libs/build/three.module.js';import{CONTAINED}from'./Constants.js';import{OrientedBox}from'../math/OrientedBox.js';import{ExtendedTriangle}from'../math/ExtendedTriangle.js';import{intersectTris,intersectClosestTri}from'../utils/GeometryRayIntersectUtilities.js';import{setTriangle}from'../utils/TriangleUtilities.js';import{arrayToBox}from'../utils/ArrayBoxUtilities.js';import{PrimitivePool}from'../utils/PrimitivePool.js';import{COUNT,OFFSET,LEFT_NODE,RIGHT_NODE,IS_LEAF,BOUNDING_DATA_INDEX,SPLIT_AXIS}from'./nodeBufferFunctions.js';function _0x408c(){const _0x784d27=['computeBoundingBox','copy','attributes','947748rZSGan','needsUpdate','boundsTree','min','boundingBox','position','direction','7sXvTRA','invert','matrix','count','intersectBox','push','point','8EVIFEj','intersectsTriangle','3992055iYvxXP','distance','intersectsBox','2800MFkvjG','11110WvUSqL','index','990162XuPxFm','198HafGJR','length','set','getPrimitive','782744MJsiBx','4923990PwWdTU','shapecast','pop','max','applyMatrix4','3279HgMlou'];_0x408c=function(){return _0x784d27;};return _0x408c();}const boundingBox=new Box3(),boxIntersection=new Vector3(),xyzFields=['x','y','z'];export function raycast(_0x5c6179,_0x10821b,_0x941714,_0x697b62,_0x405f61){let _0x2b26ea=_0x5c6179*0x2,_0x527286=_float32Array,_0x357924=_uint16Array,_0x2fc4c4=_uint32Array;const _0x52554a=IS_LEAF(_0x2b26ea,_0x357924);if(_0x52554a){const _0x426df9=OFFSET(_0x5c6179,_0x2fc4c4),_0x4ff657=COUNT(_0x2b26ea,_0x357924);intersectTris(_0x10821b,_0x941714,_0x697b62,_0x426df9,_0x4ff657,_0x405f61);}else{const _0x4152f8=LEFT_NODE(_0x5c6179);intersectRay(_0x4152f8,_0x527286,_0x697b62,boxIntersection)&&raycast(_0x4152f8,_0x10821b,_0x941714,_0x697b62,_0x405f61);const _0x50be5f=RIGHT_NODE(_0x5c6179,_0x2fc4c4);intersectRay(_0x50be5f,_0x527286,_0x697b62,boxIntersection)&&raycast(_0x50be5f,_0x10821b,_0x941714,_0x697b62,_0x405f61);}}export function raycastFirst(_0x37df98,_0x2857b0,_0x501737,_0x3aeddf){const _0x2f5e74=_0x2f09;let _0xfe5be0=_0x37df98*0x2,_0x2ea2fc=_float32Array,_0x43ace1=_uint16Array,_0x5f3630=_uint32Array;const _0x48188f=IS_LEAF(_0xfe5be0,_0x43ace1);if(_0x48188f){const _0x378555=OFFSET(_0x37df98,_0x5f3630),_0x253ee0=COUNT(_0xfe5be0,_0x43ace1);return intersectClosestTri(_0x2857b0,_0x501737,_0x3aeddf,_0x378555,_0x253ee0);}else{const _0x8d49b0=SPLIT_AXIS(_0x37df98,_0x5f3630),_0x2a1936=xyzFields[_0x8d49b0],_0x2756dc=_0x3aeddf[_0x2f5e74(0x181)][_0x2a1936],_0x13d2e4=_0x2756dc>=0x0;let _0x55175f,_0x46f4d3;_0x13d2e4?(_0x55175f=LEFT_NODE(_0x37df98),_0x46f4d3=RIGHT_NODE(_0x37df98,_0x5f3630)):(_0x55175f=RIGHT_NODE(_0x37df98,_0x5f3630),_0x46f4d3=LEFT_NODE(_0x37df98));const _0x2fc4e6=intersectRay(_0x55175f,_0x2ea2fc,_0x3aeddf,boxIntersection),_0x5c9b93=_0x2fc4e6?raycastFirst(_0x55175f,_0x2857b0,_0x501737,_0x3aeddf):null;if(_0x5c9b93){const _0x348f3e=_0x5c9b93[_0x2f5e74(0x188)][_0x2a1936],_0x184be4=_0x13d2e4?_0x348f3e<=_0x2ea2fc[_0x46f4d3+_0x8d49b0]:_0x348f3e>=_0x2ea2fc[_0x46f4d3+_0x8d49b0+0x3];if(_0x184be4)return _0x5c9b93;}const _0x1e746b=intersectRay(_0x46f4d3,_0x2ea2fc,_0x3aeddf,boxIntersection),_0x41be12=_0x1e746b?raycastFirst(_0x46f4d3,_0x2857b0,_0x501737,_0x3aeddf):null;return _0x5c9b93&&_0x41be12?_0x5c9b93[_0x2f5e74(0x18c)]<=_0x41be12[_0x2f5e74(0x18c)]?_0x5c9b93:_0x41be12:_0x5c9b93||_0x41be12||null;}}function _0x2f09(_0x52124f,_0x3b7d10){const _0x408c96=_0x408c();return _0x2f09=function(_0x2f0968,_0x40ef34){_0x2f0968=_0x2f0968-0x17c;let _0xcafc4a=_0x408c96[_0x2f0968];return _0xcafc4a;},_0x2f09(_0x52124f,_0x3b7d10);}export const shapecast=(function(){let _0x54785a,_0x4e261c;const _0x419616=[],_0x4c2a0b=new PrimitivePool(()=>new Box3());return function _0x58f700(..._0x1eb02c){const _0x1d7731=_0x2f09;_0x54785a=_0x4c2a0b[_0x1d7731(0x195)](),_0x4e261c=_0x4c2a0b[_0x1d7731(0x195)](),_0x419616[_0x1d7731(0x187)](_0x54785a,_0x4e261c);const _0x5036a1=_0x5a05dc(..._0x1eb02c);_0x4c2a0b['releasePrimitive'](_0x54785a),_0x4c2a0b['releasePrimitive'](_0x4e261c),_0x419616['pop'](),_0x419616[_0x1d7731(0x199)]();const _0x2b6896=_0x419616[_0x1d7731(0x193)];return _0x2b6896>0x0&&(_0x4e261c=_0x419616[_0x2b6896-0x1],_0x54785a=_0x419616[_0x2b6896-0x2]),_0x5036a1;};function _0x5a05dc(_0x523515,_0x35ed5e,_0xabd996,_0x4c5e46,_0x16053e=null,_0x19afa9=0x0,_0x4f4f16=0x0){function _0x1ca99e(_0x403839){let _0x374971=_0x403839*0x2,_0x256516=_uint16Array,_0x354437=_uint32Array;while(!IS_LEAF(_0x374971,_0x256516)){_0x403839=LEFT_NODE(_0x403839),_0x374971=_0x403839*0x2;}return OFFSET(_0x403839,_0x354437);}function _0x2aab4f(_0x40d423){let _0x128021=_0x40d423*0x2,_0x39760e=_uint16Array,_0x5358a0=_uint32Array;while(!IS_LEAF(_0x128021,_0x39760e)){_0x40d423=RIGHT_NODE(_0x40d423,_0x5358a0),_0x128021=_0x40d423*0x2;}return OFFSET(_0x40d423,_0x5358a0)+COUNT(_0x128021,_0x39760e);}let _0x1afb67=_0x523515*0x2,_0x3868f6=_float32Array,_0x577850=_uint16Array,_0x5d4b50=_uint32Array;const _0x4d4580=IS_LEAF(_0x1afb67,_0x577850);if(_0x4d4580){const _0x2447bd=OFFSET(_0x523515,_0x5d4b50),_0x3f7ce5=COUNT(_0x1afb67,_0x577850);return arrayToBox(BOUNDING_DATA_INDEX(_0x523515),_0x3868f6,_0x54785a),_0x4c5e46(_0x2447bd,_0x3f7ce5,![],_0x4f4f16,_0x19afa9+_0x523515,_0x54785a);}else{const _0x1b2773=LEFT_NODE(_0x523515),_0x9ec1cb=RIGHT_NODE(_0x523515,_0x5d4b50);let _0x266b5a=_0x1b2773,_0x4a2d87=_0x9ec1cb,_0x282e21,_0x544a22,_0x22b316,_0x3bb985;if(_0x16053e){_0x22b316=_0x54785a,_0x3bb985=_0x4e261c,arrayToBox(BOUNDING_DATA_INDEX(_0x266b5a),_0x3868f6,_0x22b316),arrayToBox(BOUNDING_DATA_INDEX(_0x4a2d87),_0x3868f6,_0x3bb985),_0x282e21=_0x16053e(_0x22b316),_0x544a22=_0x16053e(_0x3bb985);if(_0x544a22<_0x282e21){_0x266b5a=_0x9ec1cb,_0x4a2d87=_0x1b2773;const _0x4e8cd4=_0x282e21;_0x282e21=_0x544a22,_0x544a22=_0x4e8cd4,_0x22b316=_0x3bb985;}}!_0x22b316&&(_0x22b316=_0x54785a,arrayToBox(BOUNDING_DATA_INDEX(_0x266b5a),_0x3868f6,_0x22b316));const _0x37a48e=IS_LEAF(_0x266b5a*0x2,_0x577850),_0x36133c=_0xabd996(_0x22b316,_0x37a48e,_0x282e21,_0x4f4f16+0x1,_0x19afa9+_0x266b5a);let _0x1ef4ec;if(_0x36133c===CONTAINED){const _0x3f5cbd=_0x1ca99e(_0x266b5a),_0x5b72ca=_0x2aab4f(_0x266b5a),_0x13e08a=_0x5b72ca-_0x3f5cbd;_0x1ef4ec=_0x4c5e46(_0x3f5cbd,_0x13e08a,!![],_0x4f4f16+0x1,_0x19afa9+_0x266b5a,_0x22b316);}else _0x1ef4ec=_0x36133c&&_0x5a05dc(_0x266b5a,_0x35ed5e,_0xabd996,_0x4c5e46,_0x16053e,_0x19afa9,_0x4f4f16+0x1);if(_0x1ef4ec)return!![];_0x3bb985=_0x4e261c,arrayToBox(BOUNDING_DATA_INDEX(_0x4a2d87),_0x3868f6,_0x3bb985);const _0x2e23f3=IS_LEAF(_0x4a2d87*0x2,_0x577850),_0x549f62=_0xabd996(_0x3bb985,_0x2e23f3,_0x544a22,_0x4f4f16+0x1,_0x19afa9+_0x4a2d87);let _0x3323e7;if(_0x549f62===CONTAINED){const _0x151ea1=_0x1ca99e(_0x4a2d87),_0x4b6200=_0x2aab4f(_0x4a2d87),_0x565a6b=_0x4b6200-_0x151ea1;_0x3323e7=_0x4c5e46(_0x151ea1,_0x565a6b,!![],_0x4f4f16+0x1,_0x19afa9+_0x4a2d87,_0x3bb985);}else _0x3323e7=_0x549f62&&_0x5a05dc(_0x4a2d87,_0x35ed5e,_0xabd996,_0x4c5e46,_0x16053e,_0x19afa9,_0x4f4f16+0x1);if(_0x3323e7)return!![];return![];}}}());export const intersectsGeometry=(function(){const _0x4b97c1=new ExtendedTriangle(),_0x30cb11=new ExtendedTriangle(),_0x1a98d1=new Matrix4(),_0x4bcee5=new OrientedBox(),_0x16b06d=new OrientedBox();return function _0x55ea10(_0xf790c1,_0x1b15de,_0x344cf,_0x523ce6,_0xd5962=null){const _0x337cda=_0x2f09;let _0x38a3de=_0xf790c1*0x2,_0x33c8bb=_float32Array,_0x408c9a=_uint16Array,_0x23be69=_uint32Array;_0xd5962===null&&(!_0x344cf[_0x337cda(0x17f)]&&_0x344cf[_0x337cda(0x19d)](),_0x4bcee5[_0x337cda(0x194)](_0x344cf['boundingBox'][_0x337cda(0x17e)],_0x344cf[_0x337cda(0x17f)][_0x337cda(0x19a)],_0x523ce6),_0xd5962=_0x4bcee5);const _0x3c83ff=IS_LEAF(_0x38a3de,_0x408c9a);if(_0x3c83ff){const _0x56b2b8=_0x1b15de,_0x5e9ada=_0x56b2b8['index'],_0xcad9ca=_0x56b2b8['attributes'][_0x337cda(0x180)],_0x448165=_0x344cf[_0x337cda(0x190)],_0x1753cf=_0x344cf[_0x337cda(0x19f)][_0x337cda(0x180)],_0x29c3be=OFFSET(_0xf790c1,_0x23be69),_0x2fa745=COUNT(_0x38a3de,_0x408c9a);_0x1a98d1['copy'](_0x523ce6)[_0x337cda(0x183)]();if(_0x344cf[_0x337cda(0x17d)]){arrayToBox(BOUNDING_DATA_INDEX(_0xf790c1),_0x33c8bb,_0x16b06d),_0x16b06d[_0x337cda(0x184)][_0x337cda(0x19e)](_0x1a98d1),_0x16b06d[_0x337cda(0x17c)]=!![];const _0x45651b=_0x344cf[_0x337cda(0x17d)][_0x337cda(0x198)]({'intersectsBounds':_0x23ec18=>_0x16b06d[_0x337cda(0x18d)](_0x23ec18),'intersectsTriangle':_0x4b3334=>{const _0x37b98f=_0x337cda;_0x4b3334['a'][_0x37b98f(0x19b)](_0x523ce6),_0x4b3334['b'][_0x37b98f(0x19b)](_0x523ce6),_0x4b3334['c'][_0x37b98f(0x19b)](_0x523ce6),_0x4b3334[_0x37b98f(0x17c)]=!![];for(let _0x26eb52=_0x29c3be*0x3,_0xc36148=(_0x2fa745+_0x29c3be)*0x3;_0x26eb52<_0xc36148;_0x26eb52+=0x3){setTriangle(_0x30cb11,_0x26eb52,_0x5e9ada,_0xcad9ca),_0x30cb11[_0x37b98f(0x17c)]=!![];if(_0x4b3334[_0x37b98f(0x18a)](_0x30cb11))return!![];}return![];}});return _0x45651b;}else for(let _0x5da5aa=_0x29c3be*0x3,_0x10741c=_0x2fa745+_0x29c3be*0x3;_0x5da5aa<_0x10741c;_0x5da5aa+=0x3){setTriangle(_0x4b97c1,_0x5da5aa,_0x5e9ada,_0xcad9ca),_0x4b97c1['a'][_0x337cda(0x19b)](_0x1a98d1),_0x4b97c1['b']['applyMatrix4'](_0x1a98d1),_0x4b97c1['c']['applyMatrix4'](_0x1a98d1),_0x4b97c1[_0x337cda(0x17c)]=!![];for(let _0x2e795a=0x0,_0x42ca71=_0x448165[_0x337cda(0x185)];_0x2e795a<_0x42ca71;_0x2e795a+=0x3){setTriangle(_0x30cb11,_0x2e795a,_0x448165,_0x1753cf),_0x30cb11[_0x337cda(0x17c)]=!![];if(_0x4b97c1[_0x337cda(0x18a)](_0x30cb11))return!![];}}}else{const _0x5e53c3=_0xf790c1+0x8,_0x1cc1b6=_0x23be69[_0xf790c1+0x6];arrayToBox(BOUNDING_DATA_INDEX(_0x5e53c3),_0x33c8bb,boundingBox);const _0x3d5b23=_0xd5962[_0x337cda(0x18d)](boundingBox)&&_0x55ea10(_0x5e53c3,_0x1b15de,_0x344cf,_0x523ce6,_0xd5962);if(_0x3d5b23)return!![];arrayToBox(BOUNDING_DATA_INDEX(_0x1cc1b6),_0x33c8bb,boundingBox);const _0x3067ba=_0xd5962[_0x337cda(0x18d)](boundingBox)&&_0x55ea10(_0x1cc1b6,_0x1b15de,_0x344cf,_0x523ce6,_0xd5962);if(_0x3067ba)return!![];return![];}};}());function intersectRay(_0x6835f4,_0x26024e,_0x52a6c5,_0x5567bb){const _0x39248a=_0x2f09;return arrayToBox(_0x6835f4,_0x26024e,boundingBox),_0x52a6c5[_0x39248a(0x186)](boundingBox,_0x5567bb);}const bufferStack=[];let _prevBuffer,_float32Array,_uint16Array,_uint32Array;export function setBuffer(_0x1256ee){const _0x38f0bc=_0x2f09;_prevBuffer&&bufferStack[_0x38f0bc(0x187)](_prevBuffer),_prevBuffer=_0x1256ee,_float32Array=new Float32Array(_0x1256ee),_uint16Array=new Uint16Array(_0x1256ee),_uint32Array=new Uint32Array(_0x1256ee);}export function clearBuffer(){const _0x530f69=_0x2f09;_prevBuffer=null,_float32Array=null,_uint16Array=null,_uint32Array=null,bufferStack[_0x530f69(0x193)]&&setBuffer(bufferStack[_0x530f69(0x199)]());}