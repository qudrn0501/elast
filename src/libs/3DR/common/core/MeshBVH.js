const _0x5318d1=_0x5afa;function _0x3d56(){const _0x59dc89=['getIndex','7KRjMBy','isInterleavedBufferAttribute','has','index','union','offset','faceIndex','slice','closestPointToPoint','distanceToSquared','add','set','shift','serialize','MeshBVH:\x20The\x20function\x20signature\x20and\x20results\x20frame\x20for\x20\x22closestPointToGeometry\x22\x20has\x20changed.\x20See\x20docs\x20for\x20new\x20signature.','isMesh','intersectsBox','sqrt','raycast','copy','materialIndex','_roots','intersectsSphere','prototype','position','length','11615580JvuDzm','point','intersectsTriangle','forEach','raycastFirst','MeshBVH.deserialize:\x20The\x20arguments\x20for\x20the\x20function\x20have\x20changed.\x20See\x20documentation\x20for\x20new\x20signature.','distanceToTriangle','matrix','groups','boundsTree','apply','applyMatrix4','attributes','shapecast','min','61104NKpRCE','byteLength','invert','MeshBVH:\x20The\x20function\x20signature\x20and\x20results\x20frame\x20for\x20\x22raycast\x22\x20has\x20changed.\x20See\x20docs\x20for\x20new\x20signature.','1398484JcWpQC','MeshBVH:\x20The\x20function\x20signature\x20and\x20results\x20frame\x20for\x20\x22closestPointToPoint\x22\x20has\x20changed.\x20See\x20docs\x20for\x20new\x20signature.','closestPointToGeometry','face','12ETSVmo','3173420sItEtC','distance','clamp','MeshBVH:\x20InterleavedBufferAttribute\x20is\x20not\x20supported\x20for\x20the\x20index\x20attribute.','needsUpdate','assign','unshift','\x22\x20has\x20changed\x20and\x20no\x20longer\x20takes\x20Mesh.\x20See\x20docs\x20for\x20new\x20signature.','getBoundingBox','isArray','useSharedArrayBuffer','data','push','geometry','clone','undefined','isMaterial','releasePrimitive','boundingBox','call','intersectsGeometry','isVector3','bvhcast','getPrimitive','307905oWkxUa','MeshBVH:\x20SharedArrayBuffer\x20is\x20not\x20available.','stride','warn','524600MSHHeG','max','boolean','side','sub','distanceToBox','array','MeshBVH.serialize:\x20The\x20arguments\x20for\x20the\x20function\x20have\x20changed.\x20See\x20documentation\x20for\x20new\x20signature.','setIndex','skip\x20tree\x20generation','refit','2377920ZHmZkN','deserialize','material','isBufferGeometry'];_0x3d56=function(){return _0x59dc89;};return _0x3d56();}(function(_0x49acf9,_0x320b8c){const _0x131dcb=_0x5afa,_0x351287=_0x49acf9();while(!![]){try{const _0x397109=-parseInt(_0x131dcb(0xea))/0x1+-parseInt(_0x131dcb(0xcd))/0x2+-parseInt(_0x131dcb(0xd1))/0x3*(-parseInt(_0x131dcb(0xee))/0x4)+-parseInt(_0x131dcb(0xd2))/0x5+parseInt(_0x131dcb(0xf9))/0x6+-parseInt(_0x131dcb(0xfe))/0x7*(-parseInt(_0x131dcb(0xc9))/0x8)+parseInt(_0x131dcb(0xba))/0x9;if(_0x397109===_0x320b8c)break;else _0x351287['push'](_0x351287['shift']());}catch(_0x31be92){_0x351287['push'](_0x351287['shift']());}}}(_0x3d56,0x8cf43));import{Vector3,BufferAttribute,Box3,FrontSide,Matrix4}from'../../libs/build/three.module.js';import{CENTER,BYTES_PER_NODE,IS_LEAFNODE_FLAG}from'./Constants.js';import{buildPackedTree}from'./buildFunctions.js';import{raycast,raycastFirst,shapecast,intersectsGeometry,setBuffer,clearBuffer}from'./castFunctions.js';import{OrientedBox}from'../math/OrientedBox.js';import{ExtendedTriangle}from'../math/ExtendedTriangle.js';import{PrimitivePool}from'../utils/PrimitivePool.js';import{arrayToBox}from'../utils/ArrayBoxUtilities.js';import{iterateOverTriangles,setTriangle}from'../utils/TriangleUtilities.js';import{convertRaycastIntersect}from'../utils/GeometryRayIntersectUtilities.js';const SKIP_GENERATION=Symbol(_0x5318d1(0xf7)),aabb=new Box3(),aabb2=new Box3(),tempMatrix=new Matrix4(),obb=new OrientedBox(),obb2=new OrientedBox(),temp=new Vector3(),temp1=new Vector3(),temp2=new Vector3(),temp3=new Vector3(),temp4=new Vector3(),tempBox=new Box3(),trianglePool=new PrimitivePool(()=>new ExtendedTriangle());export class MeshBVH{static[_0x5318d1(0xad)](_0x1f43ba,_0x3d9e96={}){const _0x6be946=_0x5318d1;if(_0x3d9e96['isBufferGeometry'])return console[_0x6be946(0xed)](_0x6be946(0xf5)),MeshBVH['serialize'](arguments[0x0],{'cloneBuffers':arguments[0x2]===undefined?!![]:arguments[0x2]});_0x3d9e96={'cloneBuffers':!![],..._0x3d9e96};const _0xc178cc=_0x1f43ba['geometry'],_0x2e9566=_0x1f43ba[_0x6be946(0xb5)],_0x46a213=_0xc178cc[_0x6be946(0xfd)]();let _0xc54a3e;return _0x3d9e96['cloneBuffers']?_0xc54a3e={'roots':_0x2e9566['map'](_0x525afc=>_0x525afc[_0x6be946(0xa7)]()),'index':_0x46a213['array']['slice']()}:_0xc54a3e={'roots':_0x2e9566,'index':_0x46a213['array']},_0xc54a3e;}static[_0x5318d1(0xfa)](_0x2f5d1b,_0x2eb74e,_0x2148f0={}){const _0x8d67e2=_0x5318d1;if(typeof _0x2148f0===_0x8d67e2(0xf0))return console['warn'](_0x8d67e2(0xbf)),MeshBVH[_0x8d67e2(0xfa)](arguments[0x0],arguments[0x1],{'setIndex':arguments[0x2]===undefined?!![]:arguments[0x2]});_0x2148f0={'setIndex':!![],..._0x2148f0};const {index:_0x1b68a1,roots:_0xa9350}=_0x2f5d1b,_0x162391=new MeshBVH(_0x2eb74e,{..._0x2148f0,[SKIP_GENERATION]:!![]});_0x162391[_0x8d67e2(0xb5)]=_0xa9350;if(_0x2148f0[_0x8d67e2(0xf6)]){const _0x31650e=_0x2eb74e[_0x8d67e2(0xfd)]();if(_0x31650e===null){const _0x113a3c=new BufferAttribute(_0x2f5d1b[_0x8d67e2(0xa3)],0x1,![]);_0x2eb74e['setIndex'](_0x113a3c);}else _0x31650e['array']!==_0x1b68a1&&(_0x31650e[_0x8d67e2(0xf4)][_0x8d67e2(0xab)](_0x1b68a1),_0x31650e[_0x8d67e2(0xd6)]=!![]);}return _0x162391;}constructor(_0x5bcdee,_0x51a48a={}){const _0x1e184e=_0x5318d1;if(!_0x5bcdee[_0x1e184e(0xfc)])throw new Error('MeshBVH:\x20Only\x20BufferGeometries\x20are\x20supported.');else{if(_0x5bcdee['index']&&_0x5bcdee[_0x1e184e(0xa3)][_0x1e184e(0xff)])throw new Error(_0x1e184e(0xd5));}_0x51a48a=Object[_0x1e184e(0xd7)]({'strategy':CENTER,'maxDepth':0x28,'maxLeafTris':0xa,'verbose':!![],'useSharedArrayBuffer':![],'setBoundingBox':!![],'onProgress':null,[SKIP_GENERATION]:![]},_0x51a48a);if(_0x51a48a[_0x1e184e(0xdc)]&&typeof SharedArrayBuffer===_0x1e184e(0xe1))throw new Error(_0x1e184e(0xeb));this[_0x1e184e(0xb5)]=null,!_0x51a48a[SKIP_GENERATION]&&(this[_0x1e184e(0xb5)]=buildPackedTree(_0x5bcdee,_0x51a48a),!_0x5bcdee['boundingBox']&&_0x51a48a['setBoundingBox']&&(_0x5bcdee[_0x1e184e(0xe4)]=this[_0x1e184e(0xda)](new Box3()))),this['geometry']=_0x5bcdee;}[_0x5318d1(0xf8)](_0x3fd50c=null){const _0x286208=_0x5318d1;_0x3fd50c&&Array[_0x286208(0xdb)](_0x3fd50c)&&(_0x3fd50c=new Set(_0x3fd50c));const _0x367bb6=this[_0x286208(0xdf)],_0x2e9f0c=_0x367bb6['index'][_0x286208(0xf4)],_0x304e5b=_0x367bb6[_0x286208(0xc6)][_0x286208(0xb8)],_0x315a41=_0x304e5b['array'],_0x57204b=_0x304e5b[_0x286208(0xa5)]||0x0;let _0x1eeabe=0x3;_0x304e5b['isInterleavedBufferAttribute']&&(_0x1eeabe=_0x304e5b[_0x286208(0xdd)][_0x286208(0xec)]);let _0xc87e2f,_0x10e942,_0x404679,_0x84087b,_0x5c3dca=0x0;const _0x3fdb4f=this[_0x286208(0xb5)];for(let _0x6c5dee=0x0,_0x371cf0=_0x3fdb4f[_0x286208(0xb9)];_0x6c5dee<_0x371cf0;_0x6c5dee++){_0xc87e2f=_0x3fdb4f[_0x6c5dee],_0x10e942=new Uint32Array(_0xc87e2f),_0x404679=new Uint16Array(_0xc87e2f),_0x84087b=new Float32Array(_0xc87e2f),_0x510f7b(0x0,_0x5c3dca),_0x5c3dca+=_0xc87e2f[_0x286208(0xca)];}function _0x510f7b(_0x11de86,_0x1abe26,_0x3959a5=![]){const _0x57fc30=_0x286208,_0x57914a=_0x11de86*0x2,_0x523c15=_0x404679[_0x57914a+0xf]===IS_LEAFNODE_FLAG;if(_0x523c15){const _0xc13ad=_0x10e942[_0x11de86+0x6],_0x2fcdd1=_0x404679[_0x57914a+0xe];let _0x1fc3ad=Infinity,_0x3e9cfc=Infinity,_0x23a0e1=Infinity,_0x42bff0=-Infinity,_0x3adac7=-Infinity,_0x48b03a=-Infinity;for(let _0x31a557=0x3*_0xc13ad,_0x1e87eb=0x3*(_0xc13ad+_0x2fcdd1);_0x31a557<_0x1e87eb;_0x31a557++){const _0x44fa46=_0x2e9f0c[_0x31a557]*_0x1eeabe+_0x57204b,_0x18ed28=_0x315a41[_0x44fa46+0x0],_0x209179=_0x315a41[_0x44fa46+0x1],_0x3b47d3=_0x315a41[_0x44fa46+0x2];if(_0x18ed28<_0x1fc3ad)_0x1fc3ad=_0x18ed28;if(_0x18ed28>_0x42bff0)_0x42bff0=_0x18ed28;if(_0x209179<_0x3e9cfc)_0x3e9cfc=_0x209179;if(_0x209179>_0x3adac7)_0x3adac7=_0x209179;if(_0x3b47d3<_0x23a0e1)_0x23a0e1=_0x3b47d3;if(_0x3b47d3>_0x48b03a)_0x48b03a=_0x3b47d3;}return _0x84087b[_0x11de86+0x0]!==_0x1fc3ad||_0x84087b[_0x11de86+0x1]!==_0x3e9cfc||_0x84087b[_0x11de86+0x2]!==_0x23a0e1||_0x84087b[_0x11de86+0x3]!==_0x42bff0||_0x84087b[_0x11de86+0x4]!==_0x3adac7||_0x84087b[_0x11de86+0x5]!==_0x48b03a?(_0x84087b[_0x11de86+0x0]=_0x1fc3ad,_0x84087b[_0x11de86+0x1]=_0x3e9cfc,_0x84087b[_0x11de86+0x2]=_0x23a0e1,_0x84087b[_0x11de86+0x3]=_0x42bff0,_0x84087b[_0x11de86+0x4]=_0x3adac7,_0x84087b[_0x11de86+0x5]=_0x48b03a,!![]):![];}else{const _0x4d30cd=_0x11de86+0x8,_0x21c84a=_0x10e942[_0x11de86+0x6],_0x208e31=_0x4d30cd+_0x1abe26,_0x2eb89e=_0x21c84a+_0x1abe26;let _0x180cd4=_0x3959a5,_0x47b59e=![],_0x21024a=![];_0x3fd50c?!_0x180cd4&&(_0x47b59e=_0x3fd50c[_0x57fc30(0xa2)](_0x208e31),_0x21024a=_0x3fd50c['has'](_0x2eb89e),_0x180cd4=!_0x47b59e&&!_0x21024a):(_0x47b59e=!![],_0x21024a=!![]);const _0x4625e7=_0x180cd4||_0x47b59e,_0x478961=_0x180cd4||_0x21024a;let _0x48c1bd=![];_0x4625e7&&(_0x48c1bd=_0x510f7b(_0x4d30cd,_0x1abe26,_0x180cd4));let _0x7e0d97=![];_0x478961&&(_0x7e0d97=_0x510f7b(_0x21c84a,_0x1abe26,_0x180cd4));const _0x5e2b65=_0x48c1bd||_0x7e0d97;if(_0x5e2b65)for(let _0x483f1a=0x0;_0x483f1a<0x3;_0x483f1a++){const _0x1177e4=_0x4d30cd+_0x483f1a,_0xfe7289=_0x21c84a+_0x483f1a,_0x1f79d6=_0x84087b[_0x1177e4],_0x40ed15=_0x84087b[_0x1177e4+0x3],_0x2b0476=_0x84087b[_0xfe7289],_0x5831cb=_0x84087b[_0xfe7289+0x3];_0x84087b[_0x11de86+_0x483f1a]=_0x1f79d6<_0x2b0476?_0x1f79d6:_0x2b0476,_0x84087b[_0x11de86+_0x483f1a+0x3]=_0x40ed15>_0x5831cb?_0x40ed15:_0x5831cb;}return _0x5e2b65;}}}['traverse'](_0x5086c8,_0x1cd743=0x0){const _0x287740=_0x5318d1,_0x339b50=this[_0x287740(0xb5)][_0x1cd743],_0x2daeb5=new Uint32Array(_0x339b50),_0x28ccb8=new Uint16Array(_0x339b50);_0x2e4e25(0x0);function _0x2e4e25(_0x3e5036,_0x508015=0x0){const _0x5e3bac=_0x3e5036*0x2,_0x45801a=_0x28ccb8[_0x5e3bac+0xf]===IS_LEAFNODE_FLAG;if(_0x45801a){const _0x41e84e=_0x2daeb5[_0x3e5036+0x6],_0x1af550=_0x28ccb8[_0x5e3bac+0xe];_0x5086c8(_0x508015,_0x45801a,new Float32Array(_0x339b50,_0x3e5036*0x4,0x6),_0x41e84e,_0x1af550);}else{const _0x8300de=_0x3e5036+BYTES_PER_NODE/0x4,_0x441204=_0x2daeb5[_0x3e5036+0x6],_0x2f3fdb=_0x2daeb5[_0x3e5036+0x7],_0xb9a52d=_0x5086c8(_0x508015,_0x45801a,new Float32Array(_0x339b50,_0x3e5036*0x4,0x6),_0x2f3fdb);!_0xb9a52d&&(_0x2e4e25(_0x8300de,_0x508015+0x1),_0x2e4e25(_0x441204,_0x508015+0x1));}}}[_0x5318d1(0xb2)](_0x1c1f1d,_0x3a0f0b=FrontSide){const _0x27abcf=_0x5318d1,_0x168fcc=this['_roots'],_0xde2643=this[_0x27abcf(0xdf)],_0x272b21=[],_0x29ddaf=_0x3a0f0b[_0x27abcf(0xe2)],_0x444693=Array[_0x27abcf(0xdb)](_0x3a0f0b),_0x55eea3=_0xde2643[_0x27abcf(0xc2)],_0x4f7584=_0x29ddaf?_0x3a0f0b[_0x27abcf(0xf1)]:_0x3a0f0b;for(let _0x4b002e=0x0,_0x36d583=_0x168fcc[_0x27abcf(0xb9)];_0x4b002e<_0x36d583;_0x4b002e++){const _0x579a30=_0x444693?_0x3a0f0b[_0x55eea3[_0x4b002e][_0x27abcf(0xb4)]][_0x27abcf(0xf1)]:_0x4f7584,_0x5ba349=_0x272b21['length'];setBuffer(_0x168fcc[_0x4b002e]),raycast(0x0,_0xde2643,_0x579a30,_0x1c1f1d,_0x272b21),clearBuffer();if(_0x444693){const _0xeaf004=_0x55eea3[_0x4b002e][_0x27abcf(0xb4)];for(let _0x4eecf2=_0x5ba349,_0x55b08f=_0x272b21[_0x27abcf(0xb9)];_0x4eecf2<_0x55b08f;_0x4eecf2++){_0x272b21[_0x4eecf2]['face']['materialIndex']=_0xeaf004;}}}return _0x272b21;}['raycastFirst'](_0x585f22,_0x1396e7=FrontSide){const _0x4463a8=_0x5318d1,_0x497735=this['_roots'],_0x57c5b8=this[_0x4463a8(0xdf)],_0x590848=_0x1396e7[_0x4463a8(0xe2)],_0x3b9550=Array[_0x4463a8(0xdb)](_0x1396e7);let _0xac0b9c=null;const _0x162d40=_0x57c5b8['groups'],_0x5cb932=_0x590848?_0x1396e7[_0x4463a8(0xf1)]:_0x1396e7;for(let _0x523aa9=0x0,_0xae104d=_0x497735[_0x4463a8(0xb9)];_0x523aa9<_0xae104d;_0x523aa9++){const _0x3444f6=_0x3b9550?_0x1396e7[_0x162d40[_0x523aa9]['materialIndex']][_0x4463a8(0xf1)]:_0x5cb932;setBuffer(_0x497735[_0x523aa9]);const _0x2297d6=raycastFirst(0x0,_0x57c5b8,_0x3444f6,_0x585f22);clearBuffer(),_0x2297d6!=null&&(_0xac0b9c==null||_0x2297d6[_0x4463a8(0xd3)]<_0xac0b9c['distance'])&&(_0xac0b9c=_0x2297d6,_0x3b9550&&(_0x2297d6[_0x4463a8(0xd0)][_0x4463a8(0xb4)]=_0x162d40[_0x523aa9][_0x4463a8(0xb4)]));}return _0xac0b9c;}[_0x5318d1(0xe6)](_0x229e72,_0x180e7e){const _0x48b88f=_0x5318d1,_0x5819fe=this[_0x48b88f(0xdf)];let _0xd05699=![];for(const _0xece3ea of this[_0x48b88f(0xb5)]){setBuffer(_0xece3ea),_0xd05699=intersectsGeometry(0x0,_0x5819fe,_0x229e72,_0x180e7e),clearBuffer();if(_0xd05699)break;}return _0xd05699;}['shapecast'](_0x24daf5,_0x36ef80,_0x2c06b3){const _0x28723b=_0x5318d1,_0x3e4752=this[_0x28723b(0xdf)];if(_0x24daf5 instanceof Function){if(_0x36ef80){const _0xbc2645=_0x36ef80;_0x36ef80=(_0x35b1a3,_0x41bccc,_0x403a8d,_0x17b5b6)=>{const _0x1fa214=_0x41bccc*0x3;return _0xbc2645(_0x35b1a3,_0x1fa214,_0x1fa214+0x1,_0x1fa214+0x2,_0x403a8d,_0x17b5b6);};}_0x24daf5={'boundsTraverseOrder':_0x2c06b3,'intersectsBounds':_0x24daf5,'intersectsTriangle':_0x36ef80,'intersectsRange':null},console[_0x28723b(0xed)]('MeshBVH:\x20Shapecast\x20function\x20signature\x20has\x20changed\x20and\x20now\x20takes\x20an\x20object\x20of\x20callbacks\x20as\x20a\x20second\x20argument.\x20See\x20docs\x20for\x20new\x20signature.');}const _0x2ff118=trianglePool['getPrimitive']();let {boundsTraverseOrder:_0x5e500c,intersectsBounds:_0x513671,intersectsRange:_0x2acec6,intersectsTriangle:_0x53db9b}=_0x24daf5;if(_0x2acec6&&_0x53db9b){const _0x448c68=_0x2acec6;_0x2acec6=(_0xde3730,_0x3b1564,_0xc7b91b,_0x285be7,_0x2d32c9)=>{if(!_0x448c68(_0xde3730,_0x3b1564,_0xc7b91b,_0x285be7,_0x2d32c9))return iterateOverTriangles(_0xde3730,_0x3b1564,_0x3e4752,_0x53db9b,_0xc7b91b,_0x285be7,_0x2ff118);return!![];};}else!_0x2acec6&&(_0x53db9b?_0x2acec6=(_0x52c58c,_0x1ef0fb,_0x1f2ff3,_0x385c4e)=>{return iterateOverTriangles(_0x52c58c,_0x1ef0fb,_0x3e4752,_0x53db9b,_0x1f2ff3,_0x385c4e,_0x2ff118);}:_0x2acec6=(_0x3bb436,_0x45e6eb,_0x585224)=>{return _0x585224;});let _0x2730a2=![],_0x4cb533=0x0;for(const _0x5c5d6a of this[_0x28723b(0xb5)]){setBuffer(_0x5c5d6a),_0x2730a2=shapecast(0x0,_0x3e4752,_0x513671,_0x2acec6,_0x5e500c,_0x4cb533),clearBuffer();if(_0x2730a2)break;_0x4cb533+=_0x5c5d6a[_0x28723b(0xca)];}return trianglePool[_0x28723b(0xe3)](_0x2ff118),_0x2730a2;}[_0x5318d1(0xe8)](_0x88be81,_0x368700,_0x1da7c5){const _0x1de9a4=_0x5318d1;let {intersectsRanges:_0x157fe4,intersectsTriangles:_0x8276e0}=_0x1da7c5;const _0x10c691=this[_0x1de9a4(0xdf)][_0x1de9a4(0xa3)],_0x12aef7=this['geometry'][_0x1de9a4(0xc6)][_0x1de9a4(0xb8)],_0x4ba330=_0x88be81['geometry']['index'],_0x7b1332=_0x88be81[_0x1de9a4(0xdf)][_0x1de9a4(0xc6)][_0x1de9a4(0xb8)];tempMatrix['copy'](_0x368700)[_0x1de9a4(0xcb)]();const _0x30c510=trianglePool[_0x1de9a4(0xe9)](),_0x1dc959=trianglePool[_0x1de9a4(0xe9)]();if(_0x8276e0){function _0x4776ae(_0x693480,_0x165272,_0x1096d6,_0x57107e,_0x4cf6c3,_0xc7726b,_0x302439,_0x408403){const _0x40f71e=_0x1de9a4;for(let _0x353f52=_0x1096d6,_0x2ccd3c=_0x1096d6+_0x57107e;_0x353f52<_0x2ccd3c;_0x353f52++){setTriangle(_0x1dc959,_0x353f52*0x3,_0x4ba330,_0x7b1332),_0x1dc959['a'][_0x40f71e(0xc5)](_0x368700),_0x1dc959['b'][_0x40f71e(0xc5)](_0x368700),_0x1dc959['c'][_0x40f71e(0xc5)](_0x368700),_0x1dc959['needsUpdate']=!![];for(let _0x2fda52=_0x693480,_0x2043a6=_0x693480+_0x165272;_0x2fda52<_0x2043a6;_0x2fda52++){setTriangle(_0x30c510,_0x2fda52*0x3,_0x10c691,_0x12aef7),_0x30c510[_0x40f71e(0xd6)]=!![];if(_0x8276e0(_0x30c510,_0x1dc959,_0x2fda52,_0x353f52,_0x4cf6c3,_0xc7726b,_0x302439,_0x408403))return!![];}}return![];}if(_0x157fe4){const _0x471a59=_0x157fe4;_0x157fe4=function(_0x528046,_0x59033c,_0x83f4d7,_0x39f723,_0x16d67b,_0x5c9202,_0x2cbf50,_0x4fd0ce){if(!_0x471a59(_0x528046,_0x59033c,_0x83f4d7,_0x39f723,_0x16d67b,_0x5c9202,_0x2cbf50,_0x4fd0ce))return _0x4776ae(_0x528046,_0x59033c,_0x83f4d7,_0x39f723,_0x16d67b,_0x5c9202,_0x2cbf50,_0x4fd0ce);return!![];};}else _0x157fe4=_0x4776ae;}_0x88be81[_0x1de9a4(0xda)](aabb2),aabb2['applyMatrix4'](_0x368700);const _0x144308=this['shapecast']({'intersectsBounds':_0x1d9805=>aabb2[_0x1de9a4(0xb0)](_0x1d9805),'intersectsRange':(_0x2abe2a,_0x48c3c9,_0x68e8df,_0x2b5477,_0x1385b9,_0x38447c)=>{const _0x25d758=_0x1de9a4;return aabb['copy'](_0x38447c),aabb[_0x25d758(0xc5)](tempMatrix),_0x88be81[_0x25d758(0xc7)]({'intersectsBounds':_0x15ee6a=>aabb['intersectsBox'](_0x15ee6a),'intersectsRange':(_0x57ea1f,_0x24d44e,_0x1b8900,_0x17072a,_0x3afc6e)=>{return _0x157fe4(_0x2abe2a,_0x48c3c9,_0x57ea1f,_0x24d44e,_0x2b5477,_0x1385b9,_0x17072a,_0x3afc6e);}});}});return trianglePool[_0x1de9a4(0xe3)](_0x30c510),trianglePool['releasePrimitive'](_0x1dc959),_0x144308;}[_0x5318d1(0xb0)](_0x36fffd,_0x3b2724){const _0x192abb=_0x5318d1;return obb[_0x192abb(0xab)](_0x36fffd['min'],_0x36fffd[_0x192abb(0xef)],_0x3b2724),obb[_0x192abb(0xd6)]=!![],this[_0x192abb(0xc7)]({'intersectsBounds':_0x5509a8=>obb[_0x192abb(0xb0)](_0x5509a8),'intersectsTriangle':_0x282051=>obb[_0x192abb(0xbc)](_0x282051)});}[_0x5318d1(0xb6)](_0x48a48f){const _0x30cd67=_0x5318d1;return this[_0x30cd67(0xc7)]({'intersectsBounds':_0x26edb6=>_0x48a48f[_0x30cd67(0xb0)](_0x26edb6),'intersectsTriangle':_0x44e25a=>_0x44e25a['intersectsSphere'](_0x48a48f)});}[_0x5318d1(0xcf)](_0x4343f2,_0x24b4c4,_0x373205={},_0x30c9e5={},_0x197fb8=0x0,_0x4c444b=Infinity){const _0x54d7e6=_0x5318d1;!_0x4343f2[_0x54d7e6(0xe4)]&&_0x4343f2['computeBoundingBox']();obb[_0x54d7e6(0xab)](_0x4343f2['boundingBox'][_0x54d7e6(0xc8)],_0x4343f2[_0x54d7e6(0xe4)][_0x54d7e6(0xef)],_0x24b4c4),obb[_0x54d7e6(0xd6)]=!![];const _0xac4bc1=this['geometry'],_0x172494=_0xac4bc1[_0x54d7e6(0xc6)]['position'],_0x572e6d=_0xac4bc1[_0x54d7e6(0xa3)],_0x5eb69e=_0x4343f2[_0x54d7e6(0xc6)][_0x54d7e6(0xb8)],_0x5ae1cc=_0x4343f2[_0x54d7e6(0xa3)],_0xde460b=trianglePool[_0x54d7e6(0xe9)](),_0x3f4486=trianglePool[_0x54d7e6(0xe9)]();let _0x46332c=temp1,_0x129a21=temp2,_0x453c4a=null,_0x42ea69=null;_0x30c9e5&&(_0x453c4a=temp3,_0x42ea69=temp4);let _0x2a89c5=Infinity,_0x4f8264=null,_0x38c911=null;tempMatrix[_0x54d7e6(0xb3)](_0x24b4c4)[_0x54d7e6(0xcb)](),obb2[_0x54d7e6(0xc1)][_0x54d7e6(0xb3)](tempMatrix),this[_0x54d7e6(0xc7)]({'boundsTraverseOrder':_0x594389=>{return obb['distanceToBox'](_0x594389);},'intersectsBounds':(_0x4c0984,_0x939b2,_0x11a94e)=>{const _0x429093=_0x54d7e6;if(_0x11a94e<_0x2a89c5&&_0x11a94e<_0x4c444b)return _0x939b2&&(obb2[_0x429093(0xc8)][_0x429093(0xb3)](_0x4c0984[_0x429093(0xc8)]),obb2['max'][_0x429093(0xb3)](_0x4c0984[_0x429093(0xef)]),obb2[_0x429093(0xd6)]=!![]),!![];return![];},'intersectsRange':(_0x58c36b,_0x1c970e)=>{const _0x1244e9=_0x54d7e6;if(_0x4343f2[_0x1244e9(0xc3)])return _0x4343f2[_0x1244e9(0xc3)][_0x1244e9(0xc7)]({'boundsTraverseOrder':_0x204641=>{const _0x44b263=_0x1244e9;return obb2[_0x44b263(0xf3)](_0x204641);},'intersectsBounds':(_0x168d2d,_0x5cfd05,_0x43ea2f)=>{return _0x43ea2f<_0x2a89c5&&_0x43ea2f<_0x4c444b;},'intersectsRange':(_0x55b7da,_0xeca677)=>{const _0x1a93e9=_0x1244e9;for(let _0x1c97aa=_0x55b7da*0x3,_0x470877=(_0x55b7da+_0xeca677)*0x3;_0x1c97aa<_0x470877;_0x1c97aa+=0x3){setTriangle(_0x3f4486,_0x1c97aa,_0x5ae1cc,_0x5eb69e),_0x3f4486['a'][_0x1a93e9(0xc5)](_0x24b4c4),_0x3f4486['b']['applyMatrix4'](_0x24b4c4),_0x3f4486['c']['applyMatrix4'](_0x24b4c4),_0x3f4486[_0x1a93e9(0xd6)]=!![];for(let _0x32280b=_0x58c36b*0x3,_0x11da7e=(_0x58c36b+_0x1c970e)*0x3;_0x32280b<_0x11da7e;_0x32280b+=0x3){setTriangle(_0xde460b,_0x32280b,_0x572e6d,_0x172494),_0xde460b[_0x1a93e9(0xd6)]=!![];const _0x39e57c=_0xde460b[_0x1a93e9(0xc0)](_0x3f4486,_0x46332c,_0x453c4a);_0x39e57c<_0x2a89c5&&(_0x129a21[_0x1a93e9(0xb3)](_0x46332c),_0x42ea69&&_0x42ea69['copy'](_0x453c4a),_0x2a89c5=_0x39e57c,_0x4f8264=_0x32280b/0x3,_0x38c911=_0x1c97aa/0x3);if(_0x39e57c<_0x197fb8)return!![];}}}});else{const _0x408ba4=_0x5ae1cc?_0x5ae1cc['count']:_0x5eb69e['count'];for(let _0xcfaee=0x0,_0x3e4f85=_0x408ba4;_0xcfaee<_0x3e4f85;_0xcfaee+=0x3){setTriangle(_0x3f4486,_0xcfaee,_0x5ae1cc,_0x5eb69e),_0x3f4486['a']['applyMatrix4'](_0x24b4c4),_0x3f4486['b'][_0x1244e9(0xc5)](_0x24b4c4),_0x3f4486['c'][_0x1244e9(0xc5)](_0x24b4c4),_0x3f4486['needsUpdate']=!![];for(let _0x399e2e=_0x58c36b*0x3,_0x58498c=(_0x58c36b+_0x1c970e)*0x3;_0x399e2e<_0x58498c;_0x399e2e+=0x3){setTriangle(_0xde460b,_0x399e2e,_0x572e6d,_0x172494),_0xde460b[_0x1244e9(0xd6)]=!![];const _0x42e3b1=_0xde460b[_0x1244e9(0xc0)](_0x3f4486,_0x46332c,_0x453c4a);_0x42e3b1<_0x2a89c5&&(_0x129a21[_0x1244e9(0xb3)](_0x46332c),_0x42ea69&&_0x42ea69[_0x1244e9(0xb3)](_0x453c4a),_0x2a89c5=_0x42e3b1,_0x4f8264=_0x399e2e/0x3,_0x38c911=_0xcfaee/0x3);if(_0x42e3b1<_0x197fb8)return!![];}}}}}),trianglePool['releasePrimitive'](_0xde460b),trianglePool[_0x54d7e6(0xe3)](_0x3f4486);if(_0x2a89c5===Infinity)return null;if(!_0x373205['point'])_0x373205[_0x54d7e6(0xbb)]=_0x129a21[_0x54d7e6(0xe0)]();else _0x373205[_0x54d7e6(0xbb)][_0x54d7e6(0xb3)](_0x129a21);_0x373205[_0x54d7e6(0xd3)]=_0x2a89c5,_0x373205[_0x54d7e6(0xa6)]=_0x4f8264;if(_0x30c9e5){if(!_0x30c9e5['point'])_0x30c9e5[_0x54d7e6(0xbb)]=_0x42ea69[_0x54d7e6(0xe0)]();else _0x30c9e5['point'][_0x54d7e6(0xb3)](_0x42ea69);_0x30c9e5[_0x54d7e6(0xbb)]['applyMatrix4'](tempMatrix),_0x129a21[_0x54d7e6(0xc5)](tempMatrix),_0x30c9e5['distance']=_0x129a21[_0x54d7e6(0xf2)](_0x30c9e5['point'])[_0x54d7e6(0xb9)](),_0x30c9e5[_0x54d7e6(0xa6)]=_0x38c911;}return _0x373205;}['closestPointToPoint'](_0x2ae935,_0x53685d={},_0x3094a7=0x0,_0x310a42=Infinity){const _0x386edc=_0x5318d1,_0x233936=_0x3094a7*_0x3094a7,_0x34e847=_0x310a42*_0x310a42;let _0x46d3cd=Infinity,_0x3da55f=null;this[_0x386edc(0xc7)]({'boundsTraverseOrder':_0x476aa0=>{const _0x2027e6=_0x386edc;return temp[_0x2027e6(0xb3)](_0x2ae935)[_0x2027e6(0xd4)](_0x476aa0['min'],_0x476aa0[_0x2027e6(0xef)]),temp[_0x2027e6(0xa9)](_0x2ae935);},'intersectsBounds':(_0xffc69,_0x1e1086,_0xc6d39e)=>{return _0xc6d39e<_0x46d3cd&&_0xc6d39e<_0x34e847;},'intersectsTriangle':(_0x280611,_0x3d798a)=>{const _0x1a2ad0=_0x386edc;_0x280611['closestPointToPoint'](_0x2ae935,temp);const _0x2a9c00=_0x2ae935[_0x1a2ad0(0xa9)](temp);return _0x2a9c00<_0x46d3cd&&(temp1[_0x1a2ad0(0xb3)](temp),_0x46d3cd=_0x2a9c00,_0x3da55f=_0x3d798a),_0x2a9c00<_0x233936?!![]:![];}});if(_0x46d3cd===Infinity)return null;const _0x1ced2e=Math[_0x386edc(0xb1)](_0x46d3cd);if(!_0x53685d['point'])_0x53685d[_0x386edc(0xbb)]=temp1[_0x386edc(0xe0)]();else _0x53685d[_0x386edc(0xbb)]['copy'](temp1);return _0x53685d['distance']=_0x1ced2e,_0x53685d[_0x386edc(0xa6)]=_0x3da55f,_0x53685d;}[_0x5318d1(0xda)](_0x1ba2c8){const _0x454d2b=_0x5318d1;_0x1ba2c8['makeEmpty']();const _0x226730=this['_roots'];return _0x226730[_0x454d2b(0xbd)](_0x5ecba4=>{const _0x4db97c=_0x454d2b;arrayToBox(0x0,new Float32Array(_0x5ecba4),tempBox),_0x1ba2c8[_0x4db97c(0xa4)](tempBox);}),_0x1ba2c8;}}const originalRaycast=MeshBVH['prototype'][_0x5318d1(0xb2)];MeshBVH[_0x5318d1(0xb7)][_0x5318d1(0xb2)]=function(..._0x28e15f){const _0x1f09f0=_0x5318d1;if(_0x28e15f[0x0]['isMesh']){console['warn'](_0x1f09f0(0xcc));const [_0x4e681e,_0xd4f78b,_0x4c95a6,_0x16c993]=_0x28e15f,_0x1001f0=originalRaycast[_0x1f09f0(0xe5)](this,_0x4c95a6,_0x4e681e['material']);return _0x1001f0[_0x1f09f0(0xbd)](_0x435ef0=>{const _0x56d183=_0x1f09f0;_0x435ef0=convertRaycastIntersect(_0x435ef0,_0x4e681e,_0xd4f78b),_0x435ef0&&_0x16c993[_0x56d183(0xde)](_0x435ef0);}),_0x16c993;}else return originalRaycast[_0x1f09f0(0xc4)](this,_0x28e15f);};const originalRaycastFirst=MeshBVH[_0x5318d1(0xb7)][_0x5318d1(0xbe)];MeshBVH[_0x5318d1(0xb7)]['raycastFirst']=function(..._0x80430e){const _0x36c181=_0x5318d1;if(_0x80430e[0x0][_0x36c181(0xaf)]){console[_0x36c181(0xed)]('MeshBVH:\x20The\x20function\x20signature\x20and\x20results\x20frame\x20for\x20\x22raycastFirst\x22\x20has\x20changed.\x20See\x20docs\x20for\x20new\x20signature.');const [_0x158771,_0x4a8b82,_0x1a68b1]=_0x80430e;return convertRaycastIntersect(originalRaycastFirst['call'](this,_0x1a68b1,_0x158771[_0x36c181(0xfb)]),_0x158771,_0x4a8b82);}else return originalRaycastFirst[_0x36c181(0xc4)](this,_0x80430e);};const originalClosestPointToPoint=MeshBVH['prototype'][_0x5318d1(0xa8)];MeshBVH[_0x5318d1(0xb7)][_0x5318d1(0xa8)]=function(..._0x1c11c7){const _0x96e96a=_0x5318d1;if(_0x1c11c7[0x0][_0x96e96a(0xaf)]){console['warn'](_0x96e96a(0xce)),_0x1c11c7[_0x96e96a(0xd8)]();const _0x258622=_0x1c11c7[0x1],_0x4ce983={};return _0x1c11c7[0x1]=_0x4ce983,originalClosestPointToPoint[_0x96e96a(0xc4)](this,_0x1c11c7),_0x258622&&_0x258622[_0x96e96a(0xb3)](_0x4ce983[_0x96e96a(0xbb)]),_0x4ce983[_0x96e96a(0xd3)];}else return originalClosestPointToPoint[_0x96e96a(0xc4)](this,_0x1c11c7);};const originalClosestPointToGeometry=MeshBVH[_0x5318d1(0xb7)][_0x5318d1(0xcf)];function _0x5afa(_0x5c35de,_0x4d1303){const _0x3d5604=_0x3d56();return _0x5afa=function(_0x5afadf,_0x2be92f){_0x5afadf=_0x5afadf-0xa2;let _0x30cfe5=_0x3d5604[_0x5afadf];return _0x30cfe5;},_0x5afa(_0x5c35de,_0x4d1303);}MeshBVH[_0x5318d1(0xb7)][_0x5318d1(0xcf)]=function(..._0x109150){const _0x4ed812=_0x5318d1,_0x50e1af=_0x109150[0x2],_0x121172=_0x109150[0x3];if(_0x50e1af&&_0x50e1af[_0x4ed812(0xe7)]||_0x121172&&_0x121172['isVector3']){console[_0x4ed812(0xed)](_0x4ed812(0xae));const _0x2f8c90={},_0x4c210e={},_0x463d41=_0x109150[0x1];return _0x109150[0x2]=_0x2f8c90,_0x109150[0x3]=_0x4c210e,originalClosestPointToGeometry[_0x4ed812(0xc4)](this,_0x109150),_0x50e1af&&_0x50e1af[_0x4ed812(0xb3)](_0x2f8c90['point']),_0x121172&&_0x121172[_0x4ed812(0xb3)](_0x4c210e[_0x4ed812(0xbb)])['applyMatrix4'](_0x463d41),_0x2f8c90[_0x4ed812(0xd3)];}else return originalClosestPointToGeometry[_0x4ed812(0xc4)](this,_0x109150);};const originalRefit=MeshBVH[_0x5318d1(0xb7)][_0x5318d1(0xf8)];MeshBVH[_0x5318d1(0xb7)][_0x5318d1(0xf8)]=function(..._0x56d48e){const _0x5cc400=_0x5318d1,_0x3caafe=_0x56d48e[0x0],_0x5d553f=_0x56d48e[0x1];if(_0x5d553f&&(_0x5d553f instanceof Set||Array[_0x5cc400(0xdb)](_0x5d553f))){console['warn']('MeshBVH:\x20The\x20function\x20signature\x20for\x20\x22refit\x22\x20has\x20changed.\x20See\x20docs\x20for\x20new\x20signature.');const _0x3f4661=new Set();_0x5d553f[_0x5cc400(0xbd)](_0x53d653=>_0x3f4661['add'](_0x53d653)),_0x3caafe&&_0x3caafe['forEach'](_0x3ca71b=>_0x3f4661[_0x5cc400(0xaa)](_0x3ca71b)),originalRefit['call'](this,_0x3f4661);}else originalRefit['apply'](this,_0x56d48e);},[_0x5318d1(0xe6),_0x5318d1(0xc7),_0x5318d1(0xb0),_0x5318d1(0xb6)][_0x5318d1(0xbd)](_0x591a3a=>{const _0x19b513=_0x5318d1,_0xe8ffcc=MeshBVH[_0x19b513(0xb7)][_0x591a3a];MeshBVH[_0x19b513(0xb7)][_0x591a3a]=function(..._0xfc0747){const _0x4d5999=_0x19b513;return(_0xfc0747[0x0]===null||_0xfc0747[0x0][_0x4d5999(0xaf)])&&(_0xfc0747[_0x4d5999(0xac)](),console[_0x4d5999(0xed)]('MeshBVH:\x20The\x20function\x20signature\x20for\x20\x22'+_0x591a3a+_0x4d5999(0xd9))),_0xe8ffcc[_0x4d5999(0xc4)](this,_0xfc0747);};});